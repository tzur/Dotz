{"version":3,"sources":["meteor://ðŸ’»app/server/publications/dotPublish.js"],"names":[],"mappings":"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","file":"/server/publications/dotPublish.js","sourcesContent":["\n/*\n * This publish is receiving profileDot and subscribe all of the dotz that were connected\n * by the owner.\n * PLEASE FIND A BETTER NAME FOR THIS PUBLISH.\n */\nMeteor.publish('availableDotzForCreate', function(profileDot){\n  if (profileDot) {\n    check(profileDot, Object);\n    let dot = profileDot;\n    let userDotzArray = [];\n    if (dot && dot.dotzConnectedByOwner) {\n      dot.dotzConnectedByOwner.forEach(function (smartRef) {\n        userDotzArray.push(smartRef.dot._id);\n      });\n      console.log(userDotzArray.length);\n      if (userDotzArray.length > 0) {\n        return Dotz.find({_id: {$in: userDotzArray}});\n      }\n    }\n  }\n\n});\n\n/*\n * This publish is userId and publishing his profile Dot\n */\nMeteor.publish('profileDot', function(userId){\n  if (userId){\n    check(userId, String);\n    let user = Meteor.users.findOne(userId);\n    return Dotz.find({_id: user.profile.profileDotId});\n  }\n});\n\n///*\n// * This publish is for publishing all the profile Dotz:\n// */\n//Meteor.publish('userProfileDotz', function(userId){\n//  if (userId){\n//    check(userId, String);\n//    let user = Meteor.users.findOne(userId);\n//    let dotzConnectedByOwner = Dotz.findOne({_id: user.profile.profileDotId}).dotzConnectedByOwner;\n//    let dotzConnectedByOwnerArray = [];\n//    dotzConnectedByOwner.forEach(function (dot) {\n//      dotzConnectedByOwnerArray.push(dot);\n//    });\n//    //let Dotz = Dotz.find({_id: user.profile.profileDotId});\n//    return dotzConnectedByOwnerArray;\n//  }\n//});\n\n\n/*\n * This publish is publishing for dot card NEED TO CUT FIELDS!!!!!!*******\n */\nMeteor.publish('dotCard', function(dotId){\n  check(dotId, String);\n  return Dotz.find(dotId)\n});\nMeteor.publish('dotShow', function( dotId ) {\n  if (dotId) {\n    check(dotId, String);\n    return Dotz.find(dotId);\n  }\n});\n\nMeteor.publish( 'dotShowByDotSlug', function( dotSlug ) {\n  if (dotSlug) {\n    check(dotSlug, String);\n    return Dotz.find({\"dotSlug\": dotSlug});\n  }\n});\n\nMeteor.publish('createByUserLists', function() {\n  let currentUser = Meteor.users.findOne(this.userId);\n  let createByUserDotz = currentUser.profile.createdByUserLists;\n  createByUserDotz.push(currentUser.profile.profileDotId);\n  return Dotz.find({_id: {$in: createByUserDotz}});\n});\n\nMeteor.publish('smartRefToUsersCursor', function(smartRefArray){\n  check(smartRefArray, Array);\n  let userIds = [];\n  smartRefArray.forEach(function(smartRef){\n    let dot = Dotz.findOne(smartRef.dot._id);\n    userIds.push(smartRef.connection.connectedByUserId);\n    userIds.push(dot.ownerUserId);\n  });\n  return Meteor.users.find({_id: {$in: userIds}}, {fields: {\"services.password\": 0, \"services.loginTokens\": 0, \"emails.address\": 0, \"emails.verified\": 0}} );\n});\n\nMeteor.publish('smartRefToDotzCursor', function(smartRefArray) {\n  check(smartRefArray, Array);\n  let dotIds = [];\n  smartRefArray.forEach(function (smartRef) {\n    dotIds.push(smartRef.dot._id);\n  });\n  return Dotz.find({_id: {$in: dotIds}}, {fields: {\"services.password\": 0, \"services.loginTokens\": 0, \"emails.address\": 0, \"emails.verified\": 0}});\n});\n"]}