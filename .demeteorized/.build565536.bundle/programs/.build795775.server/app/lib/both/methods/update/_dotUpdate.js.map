{"version":3,"sources":["meteor://ðŸ’»app/lib/both/methods/update/_dotUpdate.js"],"names":[],"mappings":"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","file":"/lib/both/methods/update/_dotUpdate.js","sourcesContent":["let _dotUpdate = (dotId, updateOptions) => {\n    try {\n      check(updateOptions, Object);\n      check(dotId, String);\n\n      Dotz.update({_id: dotId}, updateOptions);\n\n    } catch (exeption) {\n      return exeption;\n    }\n  };\n\n\nMeteor.methods({\n  updateDot(doc, documentId){\n    check(doc, Object);\n    let changeFieldsAndValues = doc.$set;\n    let updateOptions = {\n      $set: changeFieldsAndValues\n    };\n    _dotUpdate(documentId, updateOptions);\n  },\n\n  //TBD: special method for user-signUp process:\n  // Does not work with try/exception..\n  updateDotSlug(dotId, slug){\n    check(dotId, String);\n    check(slug, String);\n    Dotz.update( {_id: dotId}, {$set: {\"dotSlug\": slug}} );\n  },\n\n  likeDot(targetDotId, smartRefId, userId ){\n    check(targetDotId, String);\n    check(smartRefId, String);\n    check(userId, Meteor.userId());\n    try{\n\n      Dotz.update({_id: targetDotId, \"connectedDotzArray.dot._id\": smartRefId}, {\n        $addToSet: {\"connectedDotzArray.$.connection.likes\": userId}})\n    }\n    catch(exception){\n      return exception;\n    }\n\n  },\n  //JUST DO IT LIKE KATEY PERERERRY\n  sortByLikes(smartRef, targetDotId, newIndex){\n    check(targetDotId, String);\n    check(smartRef, Schema.dotSmartRef);\n    check(newIndex, Number);s\n    Dotz.update({ _id:targetDotId }, {\n      $pull: {connectedDotzArray: smartRef }\n    });\n    Dotz.update({ _id: targetDotId}, {\n      $push: {\n        connectedDotzArray: {\n          $each: [ smartRef ],\n          $position: newIndex\n        }\n      }\n    });\n\n  },\n  addDotToConnectedDotzArray(smartRef){\n    check(smartRef, Schema.dotSmartRef);\n    let updateOptions = {\n      $addToSet: {connectedDotzArray: smartRef}\n    };\n    _dotUpdate(smartRef.connection.toParentDotId, updateOptions)\n  },\n\n\n  addDotToInDotz(dotId, parentDotId){\n    check(dotId, String);\n    check(parentDotId, String);\n    let updateOptions = {\n      $addToSet: {inDotz: parentDotId}\n    };\n    _dotUpdate(dotId, updateOptions)\n  },\n\n  sortDotzUpdate(smartRef, newIndex ){\n    check(smartRef, Schema.dotSmartRef);\n    check(newIndex, Number);\n    try {\n      Dotz.update({ _id: smartRef.connection.toParentDotId }, {\n        $pull: {connectedDotzArray: smartRef }\n      });\n      Dotz.update({ _id: smartRef.connection.toParentDotId }, {\n        $push: {\n          connectedDotzArray: {\n            $each: [ smartRef ],\n            $position: newIndex\n          }\n        }\n      });\n    }\n    catch(exception){\n      return exception;\n    }\n  }\n\n  //editDotImage(coverImageUrl, dotId){\n  //  //change to URL in check\n  //  check(coverImageUrl, String);\n  //  let updateOptions = {\n  //    $set: {coverImageUrl: coverImageUrl}\n  //  };\n  //  _dotUpdate(dotId, updateOptions)\n  //},\n  //\n  //editDotLocation(locationObject, dotId){\n  //  //change to URL in check\n  //  check(locationObject, Object);\n  //  let locationSchemaObject= {};\n  //  locationSchemaObject = {\n  //    latLng: locationObject.locationLatLng,\n  //    name: locationObject.general.name,\n  //    address: locationObject.general.formatted_address,\n  //    googleMapsUrl: locationObject.general.url,\n  //    placeId: locationObject.general.place_id,\n  //    placePhoneNumber: locationObject.general.formatted_phone_number\n  //  };\n  //  check(locationSchemaObject, Schema.location);\n  //  let updateOptions = {\n  //    $set: {\"location\": locationSchemaObject}\n  //  };\n  //  _dotUpdate(dotId, updateOptions)\n  //}\n\n});\n"]}